<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="theme-color" content="#05070d" />
    <title>BestShot · Terminal Darkroom</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
  </head>
  <body>
    <div class="shell">
      <aside class="panel panel--left">
        <div class="brand">
          <p class="brand-kicker">bestshot</p>
          <h1>Darkroom</h1>
          <p class="brand-copy">Drop, rank, and file your selects in a dockerized studio.</p>
        </div>
        <div class="panel-section">
          <div class="panel-head">
            <h2>Projects</h2>
            <button id="refresh-projects" class="text-button" aria-label="Reload projects">
              ↺ refresh
            </button>
          </div>
          <ul id="projects-list" class="projects"></ul>
        </div>
        <form id="new-project-form" class="panel-form">
          <label for="project-name">Create project</label>
          <input
            type="text"
            id="project-name"
            name="project-name"
            placeholder="night-run-01"
            autocomplete="off"
            required
          />
          <textarea
            id="project-description-input"
            name="project-description"
            placeholder='Optional note (e.g. "Portrait set B")'
            rows="2"
          ></textarea>
          <button type="submit" class="primary">Spin up</button>
        </form>
      </aside>

      <section class="panel panel--right">
        <header class="workspace-header">
          <div>
            <p class="eyebrow">project</p>
            <h2 id="workspace-title">Select a project</h2>
            <p id="workspace-meta" class="muted"></p>
          </div>
          <div class="workspace-actions">
            <div class="search-box">
              <input type="text" id="search-input" placeholder="Search by name or tag..." autocomplete="off" />
              <button id="clear-search" class="search-clear" hidden aria-label="Clear search">&times;</button>
            </div>
            <div class="view-toggle" role="group" aria-label="View mode">
              <button class="toggle active" data-view-mode="rank">Rank</button>
              <button class="toggle" data-view-mode="gallery">Gallery</button>
            </div>
            <div class="media-filter" role="group" aria-label="Media filter">
              <button class="toggle active" data-media-filter="all">Both</button>
              <button class="toggle" data-media-filter="photos">Photos</button>
              <button class="toggle" data-media-filter="videos">Videos</button>
            </div>
            <div class="upload-actions">
              <input type="file" id="file-input" multiple hidden accept="image/jpeg,image/png,image/gif,image/bmp,image/tiff,image/webp,image/heic,video/mp4,video/quicktime,video/x-msvideo,video/x-matroska,video/webm,video/x-m4v,video/x-ms-wmv,video/x-flv,video/3gpp,.jpg,.jpeg,.png,.gif,.bmp,.tif,.tiff,.webp,.heic,.mp4,.mov,.avi,.mkv,.webm,.m4v,.wmv,.flv,.3gp" />
              <button id="browse-files" class="ghost" disabled>Browse</button>
              <button id="save-order" class="primary" disabled>Save order</button>
            </div>
          </div>
        </header>

        <section class="project-note">
          <form id="project-description-form">
            <label for="project-description">Description</label>
            <textarea
              id="project-description"
              placeholder="Leave a short note for this set"
              rows="3"
              disabled
            ></textarea>
            <div class="note-actions">
              <small id="project-description-status" class="muted">Idle</small>
              <button id="save-description" class="ghost" disabled>Save note</button>
            </div>
          </form>
        </section>

        <section id="drop-zone" class="drop-zone disabled" aria-live="polite">
          <p>Drag files here or use the browser button. Media lands inside the mounted project folder.</p>
          <small>Photos: JPEG · PNG · TIFF · WebP · HEIC &nbsp;|&nbsp; Videos: MP4 · MOV · AVI · MKV · WebM</small>
        </section>

        <section class="canvas">
          <div id="images-grid" class="images-grid"></div>
        </section>
      </section>
    </div>

    <template id="image-card-template">
      <div class="image-card" draggable="true">
        <div class="image-card__head">
          <span class="rank-pill"></span>
          <p class="filename"></p>
        </div>
        <img alt="" loading="lazy" />
        <div class="image-card__tags">
          <div class="tags-list"></div>
          <div class="tag-input-wrapper" hidden>
            <input type="text" class="tag-input" placeholder="Add tag..." />
          </div>
          <button class="add-tag-btn" aria-label="Add tag">+ tag</button>
        </div>
      </div>
    </template>

    <template id="video-card-template">
      <div class="image-card video-card" draggable="true">
        <div class="image-card__head">
          <span class="rank-pill"></span>
          <p class="filename"></p>
        </div>
        <div class="video-thumbnail">
          <video muted preload="metadata"></video>
          <button class="play-button" aria-label="Play video">
            <svg viewBox="0 0 24 24" fill="currentColor" width="32" height="32">
              <path d="M8 5v14l11-7z"/>
            </svg>
          </button>
        </div>
        <div class="image-card__tags">
          <div class="tags-list"></div>
          <div class="tag-input-wrapper" hidden>
            <input type="text" class="tag-input" placeholder="Add tag..." />
          </div>
          <button class="add-tag-btn" aria-label="Add tag">+ tag</button>
        </div>
      </div>
    </template>

    <!-- Video Player Modal -->
    <div id="video-modal" class="video-modal" hidden>
      <div class="video-modal__backdrop"></div>
      <div class="video-modal__content">
        <button class="video-modal__close" aria-label="Close video">&times;</button>
        <video id="modal-video" controls autoplay></video>
        <p id="modal-video-name" class="video-modal__name"></p>
      </div>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}" defer></script>
  </body>
</html>
